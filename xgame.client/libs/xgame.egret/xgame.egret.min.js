window.egretx={};var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i};window.__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var __awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{h(n.next(e))}catch(e){o(e)}}function s(e){try{h(n.throw(e))}catch(e){o(e)}}function h(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(a,s)}h((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var i,n,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(r=n[2&o[0]?"return":o[0]?"throw":"next"])&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[0,r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},__decorate=this&&this.__decorate||function(e,t,i,n){var r,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,i,a):r(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};!function(e){var t;xgame.XGame.prototype.useEgret=function(t){this.registerServiceProvider(new e.EgretProvider(t))},function(e){e[e.INVALID=0]="INVALID",e[e.H_HEAD=1]="H_HEAD",e[e.H_MID=2]="H_MID",e[e.H_TAIL=4]="H_TAIL",e[e.V_HEAD=8]="V_HEAD",e[e.V_MID=16]="V_MID",e[e.V_TAIL=32]="V_TAIL"}(t=e.SBState||(e.SBState={})),eui.Group.prototype.onResizeChanged=function(){var e=this.__callback_onResize__;return e||(e=new xgame.Signal0,this.__callback_onResize__=e),e};var i=eui.Group.prototype.setContentSize;eui.Group.prototype.setContentSize=function(e,t){i.call(this,e,t);this.__callback_onResize__&&this.__callback_onResize__.dispatch()},eui.Group.prototype.__onHScrollChanged__=function(){var e=this.scrollV,i=this.contentHeight-this.height;i>0?e<5?this.__callback_onHS__.dispatch(t.H_HEAD):e>=5&&e<=i-5?this.__callback_onHS__.dispatch(t.H_MID):e>i-5&&this.__callback_onHS__.dispatch(t.H_TAIL):this.__callback_onHS__.dispatch(t.INVALID)},eui.Group.prototype.onHS=function(){return this.__callback_onHS__||(this.__callback_onHS__=new xgame.Signal1,this.__h_1_wacther__=eui.Binding.bindHandler(this,["contentWidth"],this.__onHScrollChanged__,this),this.__h_2_wacther__=eui.Binding.bindHandler(this,["scrollH"],this.__onHScrollChanged__,this)),this.__callback_onHS__},eui.Group.prototype.__onVScrollChanged__=function(){var e=this.scrollV,i=this.contentHeight-this.height;i>0?e<5?this.__callback_onVS__.dispatch(t.V_HEAD):e>=5&&e<=i-5?this.__callback_onVS__.dispatch(t.V_MID):e>i-5&&this.__callback_onVS__.dispatch(t.V_TAIL):this.__callback_onVS__.dispatch(t.INVALID)},eui.Group.prototype.onVS=function(){return this.__callback_onVS__||(this.__callback_onVS__=new xgame.Signal1,this.__v_1_wacther__=eui.Binding.bindHandler(this,["contentHeight"],this.__onVScrollChanged__,this),this.__v_2_wacther__=eui.Binding.bindHandler(this,["scrollV"],this.__onVScrollChanged__,this)),this.__callback_onVS__};var n=eui.Group.prototype.$onRemoveFromStage;eui.Group.prototype.$onRemoveFromStage=function(){n.apply(this);this.__callback_onResize__&&this.__callback_onResize__.removeAll(),this.__callback_onHS__&&(this.__callback_onHS__.removeAll(),this.__h_1_wacther__.unwatch(),this.__h_2_wacther__.unwatch(),this.__callback_onHS__=void 0,this.__h_1_wacther__=void 0,this.__h_2_wacther__=void 0),this.__callback_onVS__&&(this.__callback_onVS__.removeAll(),this.__v_1_wacther__.unwatch(),this.__v_2_wacther__.unwatch(),this.__callback_onVS__=void 0,this.__v_1_wacther__=void 0,this.__v_2_wacther__=void 0)},eui.DataGroup.prototype.getScroller=function(){if(this.parent&&egret.is(this.parent,"eui.Scroller"))return this.parent},eui.DataGroup.prototype.setItemWidth=function(e){this.__itemWidth__=e},eui.DataGroup.prototype.setItemHeight=function(e){this.__itemHeight__=e},eui.DataGroup.prototype.scrollToIndex=function(e){var t=this.getScroller();if(t){var i=0,n=0,r=0;egret.is(this.layout,"eui.LinearLayoutBase")&&(n=this.layout.gap),this.__itemWidth__?((r=this.contentWidth-t.width)<0&&(r=0),i=this.__itemWidth__,i+=n,(i*=e)>r&&(i=r),this.scrollH=i):this.__itemHeight__&&((r=this.contentHeight-t.height)<0&&(r=0),i=this.__itemHeight__,i+=n,(i*=e)>r&&(i=r),this.scrollV=i)}},eui.DataGroup.prototype.replaceAll=function(e,t){var i=this,n=0;"number"==typeof t&&(n=t,i.onResizeChanged().addOnce(function(){i.scrollToIndex(n)},this));var r=i.__dataSource__;null==r||"boolean"==typeof t&&t?(r=new eui.ArrayCollection(e),i.__dataSource__=r,i.dataProvider=r):r.replaceAll(e)}}(egretx||(egretx={})),function(e){e.IUIManager=Symbol.for("IUIManager")}(egretx||(egretx={})),function(e){e.IUIManagerInternal=Symbol.for("IUIManagerInternal")}(egretx||(egretx={})),function(e){var t=function(t){function i(e){var i=t.call(this)||this;return i.main=e,i.priority=100,i}return __extends(i,t),i.prototype.onInit=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,!0]})})},i.prototype.onStart=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return t.getService(e.IUIManagerInternal).initialize(),t.getService(e.ITouchManagerInternal).initialize(),[2,!0]})})},i.prototype.onServiceRegister=function(t){t.singleton(e.IUIManager,e.UIManager).withInstance(new e.UIManager(this.main)).setAlias(e.IUIManagerInternal),t.singleton(e.ITouchManager,e.TouchManager).withInstance(new e.TouchManager(this.main)).setAlias(e.ITouchManagerInternal)},i}(xgame.XObject);e.EgretProvider=t,__reflect(t.prototype,"egretx.EgretProvider",["xgame.IServiceProvider"])}(egretx||(egretx={})),function(e){e.event=xgame.event}(egretx||(egretx={})),function(e){e.impl=xgame.impl}(egretx||(egretx={})),function(e){e.inject=xgame.inject}(egretx||(egretx={})),function(e){e.injectable=xgame.injectable}(egretx||(egretx={})),function(e){e.ITouchManager=Symbol.for("ITouchManager")}(egretx||(egretx={})),function(e){e.ITouchManagerInternal=Symbol.for("ITouchManagerInternal")}(egretx||(egretx={})),function(e){e.TOUCH_TAP_BETWEEN_TIME=300,e.TOUCH_LONG_PRESS_TIME=300,e.TOUCH_SCALE_RADIO=.96,e.touchClickLastTime=0;var t=function(t){function i(e){var i=t.call(this)||this;return i.main=e,i.delegates=new xgame.Dictionary,i.stage=e.stage,i}return __extends(i,t),i.prototype.dispose=function(){this.delegates.clear(function(e){e.dispose()}),e.touchClickLastTime=0},i.prototype.initialize=function(){this.stage.addEventListener(egret.TouchEvent.LEAVE_STAGE,this.onLeaveStage,this)},i.prototype.onLeaveStage=function(e){this.delegates.forValues(function(t){t.onLeaveStage(e)},this)},i.prototype.removeTouchEvents=function(e){var t=0;(t="number"==typeof e?e:e.hashCode,this.delegates.containsKey(t))&&this.delegates.remove(t).dispose()},i.prototype.addTouchBegin=function(t,i,n,r){var o=t.hashCode;this.delegates.allocf(o,function(){return new e.TouchDelegate(t,r)}).addTouchBegin(i,n)},i.prototype.removeTouchBegin=function(t,i,n){var r=t.hashCode;this.delegates.containsKey(r)&&this.delegates.allocf(r,function(){return new e.TouchDelegate(t)}).removeTouchBegin(i,n)},i.prototype.addTouchMove=function(t,i,n){var r=t.hashCode;this.delegates.allocf(r,function(){return new e.TouchDelegate(t)}).addTouchMove(i,n)},i.prototype.removeTouchMove=function(t,i,n){var r=t.hashCode;this.delegates.containsKey(r)&&this.delegates.allocf(r,function(){return new e.TouchDelegate(t)}).removeTouchMove(i,n)},i.prototype.addTouchEnd=function(t,i,n){var r=t.hashCode;this.delegates.allocf(r,function(){return new e.TouchDelegate(t)}).addTouchEnd(i,n)},i.prototype.removeTouchEnd=function(t,i,n){var r=t.hashCode;this.delegates.containsKey(r)&&this.delegates.allocf(r,function(){return new e.TouchDelegate(t)}).removeTouchEnd(i,n)},i.prototype.addReleaseOutSide=function(t,i,n){var r=t.hashCode;this.delegates.allocf(r,function(){return new e.TouchDelegate(t)}).addReleaseOutSide(i,n)},i.prototype.removeReleaseOutSide=function(t,i,n){var r=t.hashCode;this.delegates.containsKey(r)&&this.delegates.allocf(r,function(){return new e.TouchDelegate(t)}).removeReleaseOutSide(i,n)},i.prototype.addClick=function(t,i,n,r){var o=t.hashCode;this.delegates.allocf(o,function(){return new e.TouchDelegate(t,r)}).addClick(i,n)},i.prototype.removeClick=function(t,i,n){var r=t.hashCode;this.delegates.containsKey(r)&&this.delegates.allocf(r,function(){return new e.TouchDelegate(t)}).removeClick(i,n)},i.prototype.addLongPress=function(t,i,n,r,o){var a=t.hashCode;this.delegates.allocf(a,function(){return new e.TouchDelegate(t,o)}).addLongPress(i,n,r)},i.prototype.removeLongPress=function(t,i,n){var r=t.hashCode;this.delegates.containsKey(r)&&this.delegates.allocf(r,function(){return new e.TouchDelegate(t)}).removeLongPress(i,n)},i.prototype.addRepeatPress=function(t,i,n,r,o){var a=t.hashCode;this.delegates.allocf(a,function(){return new e.TouchDelegate(t,o)}).addRepeatPress(i,n,r)},i.prototype.removeRepeatPress=function(t,i,n){var r=t.hashCode;this.delegates.containsKey(r)&&this.delegates.allocf(r,function(){return new e.TouchDelegate(t)}).removeRepeatPress(i,n)},i=__decorate([xgame.impl(xgame.IDisposable,e.ITouchManager,e.ITouchManagerInternal),__metadata("design:paramtypes",[egret.DisplayObjectContainer])],i)}(xgame.XObject);e.TouchManager=t,__reflect(t.prototype,"egretx.TouchManager",["xgame.IDisposable","xgame.IXObject","egretx.ITouchManager","egretx.ITouchManagerInternal"])}(egretx||(egretx={})),function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.top=NaN,t.bottom=NaN,t.left=NaN,t.right=NaN,t.horizontalCenter=NaN,t.verticalCenter=NaN,t.percentWidth=NaN,t.percentHeight=NaN,t.anchorOffsetX=NaN,t.anchorOffsetY=NaN,t.x=0,t.y=0,t.width=0,t.height=0,t.scaleX=1,t.scaleY=1,t}return __extends(t,e),t.prototype.reset=function(){this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.horizontalCenter=NaN,this.verticalCenter=NaN,this.percentWidth=NaN,this.percentHeight=NaN,this.anchorOffsetX=NaN,this.anchorOffsetY=NaN,this.x=0,this.y=0,this.width=0,this.height=0,this.scaleX=1,this.scaleY=1},t}(xgame.XObject);e.LayoutCache=t,__reflect(t.prototype,"egretx.LayoutCache")}(egretx||(egretx={})),function(e){var t=function(){function t(){}return t.prototype.setTouchManager=function(t){this.disposableGroup||(this.disposableGroup=new e.TouchDisposableGroup(t))},t.prototype.addTouchBegin=function(e,t,i,n){this.disposableGroup.addTouchBegin(e,t,i,n)},t.prototype.removeTouchBegin=function(e,t,i){this.disposableGroup.removeTouchBegin(e,t,i)},t.prototype.addTouchMove=function(e,t,i){this.disposableGroup.addTouchMove(e,t,i)},t.prototype.removeTouchMove=function(e,t,i){this.disposableGroup.removeTouchMove(e,t,i)},t.prototype.addTouchEnd=function(e,t,i){this.disposableGroup.addTouchEnd(e,t,i)},t.prototype.removeTouchEnd=function(e,t,i){this.disposableGroup.removeTouchEnd(e,t,i)},t.prototype.addReleaseOutSide=function(e,t,i){this.disposableGroup.addReleaseOutSide(e,t,i)},t.prototype.removeReleaseOutSide=function(e,t,i){this.disposableGroup.removeReleaseOutSide(e,t,i)},t.prototype.addClick=function(e,t,i,n){this.disposableGroup.addClick(e,t,i,n)},t.prototype.removeClick=function(e,t,i){this.disposableGroup.removeClick(e,t,i)},t.prototype.addLongPress=function(e,t,i,n,r){this.disposableGroup.addLongPress(e,t,i,n,r)},t.prototype.removeLongPress=function(e,t,i){this.disposableGroup.removeLongPress(e,t,i)},t.prototype.addRepeatPress=function(e,t,i,n,r){this.disposableGroup.addRepeatPress(e,t,i,n,r)},t.prototype.removeRepeatPress=function(e,t,i){this.disposableGroup.removeRepeatPress(e,t,i)},t}();e.TouchBehaviours=t,__reflect(t.prototype,"egretx.TouchBehaviours")}(egretx||(egretx={})),function(e){var t=function(t){function i(i,n){void 0===n&&(n=!1);var r=t.call(this)||this;return r.clickScaleEnable=!1,r.longPressTimeDelta=e.TOUCH_LONG_PRESS_TIME,r.repeatPressTimeDelta=e.TOUCH_LONG_PRESS_TIME,r.repeat_timer_id=0,r.target=i,r.clickScaleEnable=n,r.initTouchEvents(),r}return __extends(i,t),i.prototype.onLeaveStage=function(e){this.onTouchEnd(e)},i.prototype.addTouchBegin=function(e,t){this.beginHandler.listeners.add(e,t)},i.prototype.removeTouchBegin=function(e,t){this.beginHandler.listeners.remove(e)},i.prototype.addTouchMove=function(e,t){this.moveHandler.listeners.add(e,t)},i.prototype.removeTouchMove=function(e,t){this.moveHandler.listeners.remove(e)},i.prototype.addTouchEnd=function(e,t){this.endHandler.listeners.add(e,t)},i.prototype.removeTouchEnd=function(e,t){this.endHandler.listeners.remove(e)},i.prototype.addReleaseOutSide=function(e,t){this.releaseOutsideHandler.listeners.add(e,t)},i.prototype.removeReleaseOutSide=function(e,t){this.releaseOutsideHandler.listeners.remove(e)},i.prototype.addClick=function(e,t){this.clickHandler.listeners.add(e,t)},i.prototype.removeClick=function(e,t){this.clickHandler.listeners.remove(e)},i.prototype.addLongPress=function(e,t,i){void 0===i&&(i=300),this.longPressTimeDelta=i,this.longPressHandler.listeners.add(e,t)},i.prototype.removeLongPress=function(e,t){this.longPressHandler.listeners.remove(e)},i.prototype.addRepeatPress=function(e,t,i){void 0===i&&(i=300),this.repeatPressTimeDelta=i,this.repeatPressHandler.listeners.add(e,t)},i.prototype.removeRepeatPress=function(e,t){this.repeatPressHandler.listeners.remove(e)},i.prototype.initTouchEvents=function(){this.inited=!0,this.clickHandler={listeners:new xgame.Signal1,happend:!1},this.longPressHandler={listeners:new xgame.Signal1,happend:!1},this.repeatPressHandler={listeners:new xgame.Signal1,happend:!1},this.releaseOutsideHandler={listeners:new xgame.Signal1,happend:!1},this.beginHandler={listeners:new xgame.Signal1,happend:!1},this.moveHandler={listeners:new xgame.Signal1,happend:!1},this.endHandler={listeners:new xgame.Signal1,happend:!1},this.target.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.target.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.target.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.target.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this)},i.prototype.setRepeatTimer=function(){var e=this;this.clearRepeatTimer(),this.repeat_timer_id=egret.setInterval(function(){e.repeatPressHandler.happend=!0,e.repeatPressHandler.listeners.dispatch(null)},this,this.repeatPressTimeDelta)},i.prototype.clearRepeatTimer=function(){this.repeat_timer_id&&egret.clearInterval(this.repeat_timer_id),this.repeat_timer_id=0},i.prototype.onTouchBegin=function(e){this.clickScaleEnable&&(this.cacheLayout(),this.updateLayout()),this.beginHandler.happend=!0,this.beginHandler.time=egret.getTimer(),this.beginHandler.identifier=e.touchPointID,this.beginHandler.listeners.dispatch(e),this.repeatPressHandler.listeners.numListeners&&this.setRepeatTimer()},i.prototype.cacheLayout=function(){this.cache||(this.cache=new e.LayoutCache),this.cache.x=this.target.x,this.cache.y=this.target.y,this.cache.width=this.target.width,this.cache.height=this.target.height,this.cache.scaleX=this.target.scaleX,this.cache.scaleY=this.target.scaleY,this.cache.anchorOffsetX=this.target.anchorOffsetX,this.cache.anchorOffsetY=this.target.anchorOffsetY,this.target instanceof eui.Component&&(this.cache.top=this.target.top,this.cache.bottom=this.target.bottom,this.cache.left=this.target.left,this.cache.right=this.target.right,this.cache.horizontalCenter=this.target.horizontalCenter,this.cache.verticalCenter=this.target.verticalCenter,this.cache.percentWidth=this.target.percentWidth,this.cache.percentHeight=this.target.percentHeight)},i.prototype.updateLayout=function(t){this.cache&&(t?(this.target.x=this.cache.x,this.target.y=this.cache.y,this.target.width=this.cache.width,this.target.height=this.cache.height,this.target.scaleX=this.cache.scaleX,this.target.scaleY=this.cache.scaleY,this.target.anchorOffsetX=this.cache.anchorOffsetX,this.target.anchorOffsetY=this.cache.anchorOffsetY,this.target instanceof eui.Component&&(this.target.top=this.cache.top,this.target.bottom=this.cache.bottom,this.target.left=this.cache.left,this.target.right=this.cache.right,this.target.horizontalCenter=this.cache.horizontalCenter,this.target.verticalCenter=this.cache.verticalCenter,this.target.percentWidth=this.cache.percentWidth,this.target.percentHeight=this.cache.percentHeight)):(this.target.width=this.cache.width,this.target.height=this.cache.height,this.target.anchorOffsetX=this.cache.width/2,this.target.anchorOffsetY=this.cache.height/2,this.target.x+=this.cache.width*this.cache.scaleX/2,this.target.y+=this.cache.height*this.cache.scaleY/2,this.target.scaleX=this.cache.scaleX*e.TOUCH_SCALE_RADIO,this.target.scaleY=this.cache.scaleY*e.TOUCH_SCALE_RADIO,this.target instanceof eui.Component&&(this.target.top=NaN,this.target.bottom=NaN,this.target.left=NaN,this.target.right=NaN,this.target.horizontalCenter=NaN,this.target.verticalCenter=NaN,this.target.percentWidth=NaN,this.target.percentHeight=NaN)))},i.prototype.onTouchMove=function(e){this.beginHandler.happend&&this.moveHandler.listeners.dispatch(e)},i.prototype.onTouchEnd=function(t){if(this.beginHandler.happend){if(this.clickScaleEnable&&this.updateLayout(!0),t.type==egret.TouchEvent.TOUCH_RELEASE_OUTSIDE)this.releaseOutsideHandler.listeners.dispatch(t);else{this.endHandler.listeners.dispatch(t);var i=egret.getTimer();!this.repeatPressHandler.happend&&this.longPressHandler.listeners.numListeners&&i-this.beginHandler.time>=this.longPressTimeDelta&&(this.longPressHandler.happend=!0,this.longPressHandler.listeners.dispatch(t)),this.longPressHandler.happend||this.repeatPressHandler.happend||i-e.touchClickLastTime>e.TOUCH_TAP_BETWEEN_TIME&&(e.touchClickLastTime=i,this.clickHandler.listeners.dispatch(t))}this.clearRepeatTimer(),this.beginHandler.happend=!1,this.endHandler.happend=!1,this.moveHandler.happend=!1,this.releaseOutsideHandler.happend=!1,this.longPressHandler.happend=!1,this.repeatPressHandler.happend=!1}},i.prototype.dispose=function(){this.cache=void 0,this.target&&(this.target.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.target.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.target.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.target.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this)),this.clickHandler.listeners.removeAll(),this.clickHandler.happend=!1,this.longPressHandler.listeners.removeAll(),this.longPressHandler.happend=!1,this.repeatPressHandler.listeners.removeAll(),this.repeatPressHandler.happend=!1,this.releaseOutsideHandler.listeners.removeAll(),this.releaseOutsideHandler.happend=!1,this.beginHandler.listeners.removeAll(),this.beginHandler.happend=!1,this.moveHandler.listeners.removeAll(),this.moveHandler.happend=!1,this.endHandler.listeners.removeAll(),this.endHandler.happend=!1,this.target=void 0,this.inited=!1},i}(xgame.XObject);e.TouchDelegate=t,__reflect(t.prototype,"egretx.TouchDelegate",["xgame.IDisposable","xgame.IXObject"])}(egretx||(egretx={})),function(e){var t=function(t){function i(e){var i=t.call(this)||this;return i.displayObject=e,i.touches=new xgame.List,xgame.injectInstance(i),i.displayObject&&i.displayObject.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemovedFromStage,i),i}return __extends(i,t),i.prototype.onRemovedFromStage=function(){this.dispose()},i.prototype.dispose=function(){var e=this;this.touches.forEach(function(t){e.manager.removeTouchEvents(t)}),this.touches.clear(),this.displayObject&&this.displayObject.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemovedFromStage,this),this.manager=void 0,this.displayObject=void 0},i.prototype.addTouchBegin=function(e,t,i,n){this.manager.addTouchBegin(e,t,i,n),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.removeTouchBegin=function(e,t,i){this.manager.removeTouchBegin(e,t,i),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.addTouchMove=function(e,t,i){this.manager.addTouchMove(e,t,i),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.removeTouchMove=function(e,t,i){this.manager.removeTouchMove(e,t,i),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.addTouchEnd=function(e,t,i){this.manager.addTouchEnd(e,t,i),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.removeTouchEnd=function(e,t,i){this.manager.removeTouchEnd(e,t,i),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.addReleaseOutSide=function(e,t,i){this.manager.addReleaseOutSide(e,t,i),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.removeReleaseOutSide=function(e,t,i){this.manager.removeReleaseOutSide(e,t,i),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.addClick=function(e,t,i,n){this.manager.addClick(e,t,i,n),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.removeClick=function(e,t,i){this.manager.removeClick(e,t,i),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.addLongPress=function(e,t,i,n,r){this.manager.addLongPress(e,t,i,n,r),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.removeLongPress=function(e,t,i){this.manager.removeLongPress(e,t,i),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.addRepeatPress=function(e,t,i,n,r){this.manager.addRepeatPress(e,t,i,n,r),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},i.prototype.removeRepeatPress=function(e,t,i){this.manager.removeRepeatPress(e,t,i),this.touches.contains(e.hashCode)||this.touches.add(e.hashCode)},__decorate([xgame.inject(e.ITouchManager),__metadata("design:type",e.TouchManager)],i.prototype,"manager",void 0),i}(xgame.XObject);e.TouchDisposableGroup=t,__reflect(t.prototype,"egretx.TouchDisposableGroup",["xgame.IDisposable","xgame.IXObject"])}(egretx||(egretx={})),function(e){var t=function(t){function i(i){var n=t.call(this)||this;return n.main=i,n.pipelines=[],n.uiMap=new xgame.Dictionary,n.uiLayers=new xgame.Dictionary,n.root=new eui.UILayer,n.onSceneChanged=new xgame.Signal2,n.onUIOpened=new xgame.Signal1,n.onUIClosed=new xgame.Signal1,n.RES=new e.UIResManager,n.stage=i.stage,n}return __extends(i,t),i.prototype.initialize=function(){this.entityManager=new e.UIEntityManager(this),this.pipelines.push(this.checkIsOpened.bind(this)),this.pipelines.push(this.createUIPage.bind(this)),this.pipelines.push(this.openUIPage.bind(this)),this.root.name="UIRoot",this.main.addChild(this.root);for(var t=e.UILayerID.Layer_0_Bottom;t<=e.UILayerID.Layer_15_Top;t++){var i=new e.UILayerManager(this,t);this.root.addChildAt(i,t),this.uiLayers.add(t,i)}this.register(e.Alert.NAME,e.Alert),this.register(e.PopupMenu.NAME,e.PopupMenu),e.TipsManager.Instance().initialize()},Object.defineProperty(i.prototype,"sceneTransition",{get:function(){return this.$sceneTransition},enumerable:!0,configurable:!0}),i.prototype.setSceneTransition=function(e){this.$sceneTransition=e},i.prototype.getLayerManager=function(e){return this.uiLayers.get(e)},i.prototype.register=function(e,t){this.uiMap.add(e,t)},i.prototype.popUI=function(){return!1},i.prototype.clearScene=function(){this.currentScene&&(this._closeUI(this.$currentScene),this.$currentScene=void 0)},i.prototype.closeUI=function(e){if("string"==typeof e){var t=e,i=[];if(this.entityManager.tryGetEntities(t,i))for(var n=0,r=i;n<r.length;n++){var o=r[n];this._closeUI(o)}}else this._closeUI(e)},i.prototype._closeUI=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:return e.isClosed?[2]:(this.uiLayers.get(e.uiPage.layerID).removeEntity(e),this.entityManager.removeEntity(e),[4,(t=e.uiPage).doFadeOut()]);case 1:return i.sent(),t.parent&&e.uiPage.parent.removeChild(e.uiPage),e.mask&&e.mask.parent&&e.mask.parent.removeChild(e.mask),this.onUIClosed.dispatch(e),this.entityManager.checkEntities(),e.onClose(),e.dispose(),e=void 0,[2]}})})},Object.defineProperty(i.prototype,"currentScene",{get:function(){return this.$currentScene},enumerable:!0,configurable:!0}),i.prototype.replaceScene=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return __awaiter(this,void 0,void 0,function(){var n,r,o;return __generator(this,function(a){switch(a.label){case 0:if(o=new e.UIOptions,"string"==typeof t){if(n=t,!this.uiMap.containsKey(n))throw new Error("此UI没有注册:{0}".format(n));r=this.uiMap.get(n)}else r=t;return o.uiClass=r,o.openArgs=i,o.name=xgame.getQualifiedClassName(r),this.currentScene&&this.$currentScene.onSceneChanging(),[4,this.startPipelines(o)];case 1:return[2,a.sent()]}})})},i.prototype.openUI=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return __awaiter(this,void 0,void 0,function(){var n,r,o;return __generator(this,function(a){switch(a.label){case 0:if(o=new e.UIOptions,"string"==typeof t){if(n=t,!this.uiMap.containsKey(n))throw new Error("此UI没有注册:{0}".format(n));r=this.uiMap.get(n)}else r=t;return o.uiClass=r,o.openArgs=i,o.name=xgame.getQualifiedClassName(r),[4,this.startPipelines(o)];case 1:return[2,a.sent()]}})})},i.prototype.openUIWithLayer=function(t,i){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return __awaiter(this,void 0,void 0,function(){var r,o,a;return __generator(this,function(s){switch(s.label){case 0:if(a=new e.UIOptions,"string"==typeof t){if(r=t,!this.uiMap.containsKey(r))throw new Error("此UI没有注册:{0}".format(r));o=this.uiMap.get(r)}else o=t;return a.uiClass=o,a.layerID=i,a.openArgs=n,a.name=xgame.getQualifiedClassName(o),[4,this.startPipelines(a)];case 1:return[2,s.sent()]}})})},i.prototype.openUIWithRoot=function(t,i){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return __awaiter(this,void 0,void 0,function(){var r,o,a;return __generator(this,function(s){switch(s.label){case 0:if(a=new e.UIOptions,"string"==typeof t){if(r=t,!this.uiMap.containsKey(r))throw new Error("此UI没有注册:{0}".format(r));o=this.uiMap.get(r)}else o=t;return a.uiClass=o,a.uiRoot=i,a.openArgs=n,a.name=xgame.getQualifiedClassName(o),[4,this.startPipelines(a)];case 1:return[2,s.sent()]}})})},i.prototype.openPopup=function(t,i){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return __awaiter(this,void 0,void 0,function(){var r,o,a;return __generator(this,function(s){switch(s.label){case 0:if(a=new e.UIOptions,"string"==typeof t){if(r=t,!this.uiMap.containsKey(r))throw new Error("此UI没有注册:{0}".format(r));o=this.uiMap.get(r)}else o=t;return a.uiClass=o,a.hud=i,a.openArgs=n,a.name=xgame.getQualifiedClassName(o),[4,this.startPipelines(a)];case 1:return[2,s.sent()]}})})},i.prototype.startPipelines=function(e){return __awaiter(this,void 0,void 0,function(){var t,i;return __generator(this,function(n){switch(n.label){case 0:t=0,i=this.pipelines,n.label=1;case 1:return t<i.length?[4,(0,i[t])(e)]:[3,4];case 2:if(!n.sent())return e.errorMessage&&console.error(e.errorMessage),[2,null];n.label=3;case 3:return t++,[3,1];case 4:return[2,e.entity]}})})},i.prototype.checkIsOpened=function(t){return __awaiter(this,void 0,void 0,function(){var i,n;return __generator(this,function(r){return i=[],this.entityManager.tryGetEntities(t.uiClass,i)&&((n=i[0]).uiPage.flags&e.UIFlags.allowMultiple||(t.entity=n)),[2,!0]})})},i.prototype.createUIPage=function(t){return __awaiter(this,void 0,void 0,function(){var i,n,r,o,a,s=this;return __generator(this,function(h){switch(h.label){case 0:return(i=t.entity)?[3,3]:((i=new e.UIEntity).uiManager=this,i.name=t.name,t.entity=i,n=new((a=t.uiClass).bind.apply(a,[void 0].concat(t.openArgs))),xgame.injectInstance(n),n.entity=i,i.uiPage=n,this.entityManager.addEntity(i),n.onInit(),n.visible=!1,t.hud&&n.renderWatcher.onChanged().add(function(){egret.callLater(function(){e.TipsHelper.placeTipsWithHUD(n,t.hud,t.gap)},s)},this),t.uiRoot?t.uiRoot.addChild(n):(t.layerID&&n.setLayerID(t.layerID),o=this.uiLayers.get(n.layerID),n.flags&e.UIFlags.useMask&&(i.createMask(n.maskColor,n.maskAlpha,n.flags&e.UIFlags.closeByMask),o.addChild(i.mask)),t.hud||n.flags&e.UIFlags.isPlugin||(n.left=n.right=n.top=n.bottom=0),o.addEntity(i),o.addChild(n)),[4,n.load()]);case 1:return h.sent(),n.onOpen(),[4,xgame.waitEndFrames()];case 2:return h.sent(),t.hud||(n.visible=!0),[3,4];case 3:r=i.uiPage,null!=t.layerID&&t.layerID!=r.layerID?((o=this.uiLayers.get(r.layerID)).removeEntity(i),i.mask&&i.mask.parent&&i.mask.parent.removeChild(i.mask),i.uiPage&&i.uiPage.parent&&i.uiPage.parent.removeChild(i.uiPage),(o=this.uiLayers.get(t.layerID)).addEntity(i),i.mask&&o.addChild(i.mask),i.uiPage&&(i.uiPage.setLayerID(t.layerID),o.addChild(i.uiPage))):(o=this.uiLayers.get(r.layerID)).orderToFront(i),h.label=4;case 4:return this.entityManager.checkEntities(),[2,!0]}})})},i.prototype.openUIPage=function(t){return __awaiter(this,void 0,void 0,function(){var i,n;return __generator(this,function(r){switch(r.label){case 0:return(i=t.entity)?(n=i.uiPage).isLoaded?n.flags&e.UIFlags.Scene?this.currentScene?this.sceneTransition?[4,this.sceneTransition.start(this.currentScene.uiPage)]:[3,2]:[3,4]:[3,5]:(t.errorMessage="UIPage:{0}还没有加载完成".format(t.name),[2,!1]):(t.errorMessage="UIEntity:{0}不能为空".format(t.name),[2,!1]);case 1:r.sent(),r.label=2;case 2:return this.onSceneChanged.dispatch(i,this.currentScene),[4,this._closeUI(this.$currentScene)];case 3:r.sent(),r.label=4;case 4:this.$currentScene=i,r.label=5;case 5:return[4,n.doFadeIn()];case 6:return r.sent(),this.onUIOpened.dispatch(i),[2,!0]}})})},i=__decorate([xgame.impl(e.IUIManager,e.IUIManagerInternal),__metadata("design:paramtypes",[egret.DisplayObjectContainer])],i)}(xgame.XObject);e.UIManager=t,__reflect(t.prototype,"egretx.UIManager",["egretx.IUIManager","xgame.IXObject","egretx.IUIManagerInternal"])}(egretx||(egretx={})),function(e){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.setTouchManager(this)},i=__decorate([xgame.mixin(e.TouchBehaviours),__metadata("design:paramtypes",[])],i)}(eui.Group);e.Group=t,__reflect(t.prototype,"egretx.Group",["xgame.IXObject"])}(egretx||(egretx={})),function(e){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.setTouchManager(this)},i=__decorate([xgame.mixin(e.TouchBehaviours),__metadata("design:paramtypes",[])],i)}(eui.ItemRenderer);e.ItemRenderer=t,__reflect(t.prototype,"egretx.ItemRenderer")}(egretx||(egretx={})),function(e){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.setTouchManager(this)},i=__decorate([xgame.mixin(e.TouchBehaviours),__metadata("design:paramtypes",[])],i)}(eui.Component);e.UIComponent=t,__reflect(t.prototype,"egretx.UIComponent",["xgame.IXObject","eui.UIComponent","egret.DisplayObject"])}(egretx||(egretx={})),function(e){!function(e){e[e.CENTER=0]="CENTER",e[e.TOP=1]="TOP",e[e.BOTTOM=2]="BOTTOM",e[e.LEFT=3]="LEFT",e[e.RIGHT=4]="RIGHT"}(e.UIAlign||(e.UIAlign={}))}(egretx||(egretx={})),function(e){!function(e){e[e.ANY=0]="ANY",e[e.TOP=1]="TOP",e[e.BOTTOM=2]="BOTTOM",e[e.LEFT=3]="LEFT",e[e.RIGHT=4]="RIGHT"}(e.UIDirection||(e.UIDirection={}))}(egretx||(egretx={})),function(e){var t=function(t){function i(i){void 0===i&&(i=null);var n=t.call(this)||this;return n.skinPath=i,n.flags=e.UIFlags.isStack|e.UIFlags.isFullScreen,n.onComplete=new xgame.Signal0,n.$isLoaded=!1,n.$isLoading=!1,n.deferred=new xgame.Deferred,n.$maskAlpha=.5,n.$maskColor=0,n.$layerID=e.UILayerID.Layer_5_UI,n}return __extends(i,t),Object.defineProperty(i.prototype,"isLoaded",{get:function(){return this.$isLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isLoading",{get:function(){return this.$isLoading},enumerable:!0,configurable:!0}),i.prototype.load=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){return this.$isLoading=!0,this.skinPath&&!this.isLoaded?(this.once(egret.Event.COMPLETE,function(){e.doComplete()},this),this.skinName=this.skinPath):this.doComplete(),[2,this.deferred.promise]})})},i.prototype.doComplete=function(){var e=this;egret.callLater(function(){e.$isLoaded=!0,e.onComplete.dispatch(),e.deferred.resolve()},this)},Object.defineProperty(i.prototype,"maskAlpha",{get:function(){return this.$maskAlpha},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maskColor",{get:function(){return this.$maskColor},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"layerID",{get:function(){return this.$layerID},enumerable:!0,configurable:!0}),i.prototype.setLayerID=function(e){this.$layerID=e},i.prototype.onInit=function(){},i.prototype.onOpen=function(){},i.prototype.onSceneChanging=function(){},i.prototype.onClose=function(){this.entity=void 0},i.prototype.onShow=function(){},i.prototype.onHide=function(){},i.prototype.close=function(){this.entity&&this.entity.closePage()},i.prototype.doFadeIn=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},i.prototype.doFadeOut=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},i}(e.UIComponent);e.UIPage=t,__reflect(t.prototype,"egretx.UIPage")}(egretx||(egretx={})),function(e){!function(e){e[e.None=0]="None",e[e.useMask=1]="useMask",e[e.isStack=2]="isStack",e[e.isFullScreen=4]="isFullScreen",e[e.allowMultiple=8]="allowMultiple",e[e.closeByMask=16]="closeByMask",e[e.isPopupMenu=32]="isPopupMenu",e[e.isPlugin=64]="isPlugin",e[e.Scene=128]="Scene"}(e.UIFlags||(e.UIFlags={}))}(egretx||(egretx={})),function(e){var t=function(t){function i(i){var n=t.call(this,i)||this;return n.flags=e.UIFlags.isPlugin,n}return __extends(i,t),i}(e.UIPage);e.PluginPage=t,__reflect(t.prototype,"egretx.PluginPage")}(egretx||(egretx={})),function(e){var t=function(t){function i(i){var n=t.call(this,i)||this;return n.flags=e.UIFlags.isStack|e.UIFlags.useMask|e.UIFlags.closeByMask,n.setLayerID(e.UILayerID.Layer_8_Window),n}return __extends(i,t),i}(e.UIPage);e.Window=t,__reflect(t.prototype,"egretx.Window")}(egretx||(egretx={})),function(e){!function(e){e[e.Layer_0_Bottom=0]="Layer_0_Bottom",e[e.Layer_1=1]="Layer_1",e[e.Layer_2_Scene=2]="Layer_2_Scene",e[e.Layer_3_SceneMask=3]="Layer_3_SceneMask",e[e.Layer_4_SceneFrame=4]="Layer_4_SceneFrame",e[e.Layer_5_UI=5]="Layer_5_UI",e[e.Layer_6_UIMask=6]="Layer_6_UIMask",e[e.Layer_7_UIFrame=7]="Layer_7_UIFrame",e[e.Layer_8_Window=8]="Layer_8_Window",e[e.Layer_9=9]="Layer_9",e[e.Layer_10_Tips=10]="Layer_10_Tips",e[e.Layer_11_Toast=11]="Layer_11_Toast",e[e.Layer_12_Loading=12]="Layer_12_Loading",e[e.Layer_13=13]="Layer_13",e[e.Layer_14=14]="Layer_14",e[e.Layer_15_Top=15]="Layer_15_Top"}(e.UILayerID||(e.UILayerID={}))}(egretx||(egretx={})),function(e){var t=["x","y","width","height","visible","scaleX","scaleY"],i=function(e){function i(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.call(this)||this;n.views=[],n.watchers=[],n.dict=new xgame.Dictionary,n.callback_onChanged=new xgame.Signal0,n.isDispatching=!1;for(var r=0,o=t;r<o.length;r++){var a=o[r];n.addWatcher(a)}return n}return __extends(i,e),i.prototype.addWatcher=function(e){if(!(this.views.indexOf(e)>=0)){this.views.push(e);var i=this.dict.get(e.hashCode);i||(i=[],this.dict.add(e.hashCode,i));for(var n=0,r=t;n<r.length;n++){var o=r[n],a=eui.Binding.bindHandler(e,[o],this.onWatcher,this);this.watchers.push(a),i.push(a)}}},i.prototype.removeWatcher=function(e){if(this.dict.containsKey(e.hashCode)){for(var t=this.dict.get(e.hashCode),i=(this.watchers.length,0),n=t;i<n.length;i++){var r=n[i],o=this.watchers.indexOf(r);o>-1&&this.watchers.splice(o,1),r.unwatch()}t.length=0,this.dict.remove(e.hashCode)}},i.prototype.onWatcher=function(e){this.lateDispatch()},i.prototype.lateDispatch=function(){var e=this;this.isDispatching||(this.isDispatching=!0,egret.callLater(function(){e.callback_onChanged.dispatch(),e.isDispatching=!1},this))},i.prototype.onChanged=function(){return this.callback_onChanged},i.prototype.dispose=function(){for(this.callback_onChanged.removeAll();this.watchers.length;){this.watchers.shift().unwatch()}this.views&&(this.views.length=0),this.dict.clear()},i}(xgame.XObject);e.RenderWatcher=i,__reflect(i.prototype,"egretx.RenderWatcher");var n=function(t){function n(n){var r=t.call(this,n)||this;return r.renderWatcher=new i,r.offset=new egret.Point,r.$uiDirection=e.UIDirection.ANY,r.$uiAlign=e.UIAlign.CENTER,r.flags=e.UIFlags.isStack|e.UIFlags.isPopupMenu|e.UIFlags.useMask|e.UIFlags.closeByMask|e.UIFlags.allowMultiple,r.setLayerID(e.UILayerID.Layer_10_Tips),r.$maskAlpha=0,r.renderWatcher.addWatcher(r),r}return __extends(n,t),Object.defineProperty(n.prototype,"uiDirection",{get:function(){return this.$uiDirection},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"uiAlign",{get:function(){return this.$uiAlign},enumerable:!0,configurable:!0}),n.prototype.allowUIDirection=function(e){return!this.allowDirections||!this.allowDirections.length||this.allowDirections.indexOf(e)>=0},n.prototype.fixedUIDirection=function(e){},n.prototype.onClose=function(){this.renderWatcher&&this.renderWatcher.dispose(),t.prototype.onClose.call(this)},n}(e.UIPage);e.Popup=n,__reflect(n.prototype,"egretx.Popup")}(egretx||(egretx={})),function(e){var t=function(t){function i(i){var n=t.call(this,i)||this;return n.flags=e.UIFlags.Scene|e.UIFlags.isFullScreen,n.setLayerID(e.UILayerID.Layer_2_Scene),n}return __extends(i,t),i}(e.UIPage);e.Scene=t,__reflect(t.prototype,"egretx.Scene")}(egretx||(egretx={})),function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),Object.defineProperty(t.prototype,"isClosed",{get:function(){return this.$isClosed},enumerable:!0,configurable:!0}),t.prototype.createMask=function(e,t,i){this.mask||(this.mask=new eui.Rect(100,100,e),this.mask.alpha=t,this.mask.left=this.mask.right=this.mask.top=this.mask.bottom=0,i&&this.mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMaskClose,this))},t.prototype.onMaskClose=function(){this.mask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMaskClose,this),this.closePage()},t.prototype.onSceneChanging=function(){this.uiPage&&this.uiPage.onSceneChanging()},t.prototype.onClose=function(){this.$isClosed=!0,this.uiPage&&this.uiPage.onClose()},t.prototype.closePage=function(){this.uiManager&&this.uiManager.closeUI(this)},t.prototype.showPage=function(){this.uiPage&&(this.uiPage.visible=!0)},t.prototype.hidePage=function(){this.uiPage&&(this.uiPage.visible=!1)},t.prototype.dispose=function(){this.mask&&this.mask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMaskClose,this),this.uiPage=void 0,this.mask=void 0},t}(xgame.XObject);e.UIEntity=t,__reflect(t.prototype,"egretx.UIEntity",["egretx.IUIEntity","xgame.IDisposable","xgame.IXObject"])}(egretx||(egretx={})),function(e){var t=function(){function t(){}return t.isFullScreenUI=function(t){var i=t.uiPage.flags;return!!(i&e.UIFlags.isStack)&&!!(i&e.UIFlags.isFullScreen)},t.isWindowUI=function(i){var n=i.uiPage.flags;return!!(n&e.UIFlags.isStack)&&(!(n&e.UIFlags.isFullScreen)&&!t.isPopupMenuUI(i))},t.isPopupMenuUI=function(t){var i=t.uiPage.flags;return!!(i&e.UIFlags.isStack)&&(!(i&e.UIFlags.isFullScreen)&&!!(i&e.UIFlags.isPopupMenu))},t.isPluginUI=function(t){return!!(t.uiPage.flags&e.UIFlags.isPlugin)},t.isSceneUI=function(t){return!!(t.uiPage.flags&e.UIFlags.Scene)},t}();e.UIHelper=t,__reflect(t.prototype,"egretx.UIHelper")}(egretx||(egretx={})),function(e){var t=function(t){function i(e){var i=t.call(this)||this;return i.manager=e,i.entityMap=new xgame.Dictionary,i.stackList=new xgame.List,i}return __extends(i,t),i.prototype.addEntity=function(t){var i=this.entityMap.get(t.name);i||(i=[],this.entityMap.add(t.name,i)),-1==i.indexOf(t)&&(i.push(t),t.uiPage.flags&e.UIFlags.isStack&&this.stackList.add(t))},Object.defineProperty(i.prototype,"stackCount",{get:function(){return this.stackList.count()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"topUI",{get:function(){if(this.stackCount>0)return this.stackList.last()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"topFullScreenUI",{get:function(){for(var t=this.stackCount-1;t>=0;){var i=this.stackList.elementAt(t);if(i.uiPage.flags&e.UIFlags.isFullScreen)return i;t--}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hasPopUp",{get:function(){for(var t=this.stackCount-1;t>=0;){var i=this.stackList.elementAt(t);if(e.UIHelper.isWindowUI(i))return!0;t--}return!1},enumerable:!0,configurable:!0}),i.prototype.checkEntities=function(){for(var t=!0,i=!1,n=this.stackCount-1;n>=0;){var r=this.stackList.elementAt(n);t?r.showPage():r.hidePage(),r.uiPage.flags&e.UIFlags.isFullScreen&&(i=!0,t=!1),n--}i?this.hideUIUnderLayers():this.showUIUnderLayers()},i.prototype.hideUIUnderLayers=function(){var t=this;this.manager.uiLayers.forKeys(function(i){if(i>=e.UILayerID.Layer_5_UI)return!0;t.manager.uiLayers.get(i).visible=!1},this)},i.prototype.showUIUnderLayers=function(){var t=this;this.manager.uiLayers.forKeys(function(i){if(i>=e.UILayerID.Layer_5_UI)return!0;t.manager.uiLayers.get(i).visible=!0},this)},i.prototype.removeEntity=function(t){if(this.entityMap.containsKey(t.name)){var i=this.entityMap.get(t.name),n=i.indexOf(t);n>=0&&(i.splice(n,1),t.uiPage.flags&e.UIFlags.isStack&&this.stackList.remove(t))}},i.prototype.tryGetEntities=function(e,t){var i,n,r;if("string"==typeof e){if(i=e,!this.manager.uiMap.containsKey(i))throw new Error("此UI没有注册:{0}".format(i));n=this.manager.uiMap.get(i)}else n=e;if(r=xgame.getQualifiedClassName(n),this.entityMap.containsKey(r)){var o=this.entityMap.get(r);if(o&&o.length)return t&&(t.length=0,t.push.apply(t,o)),!0}return!1},i}(xgame.XObject);e.UIEntityManager=t,__reflect(t.prototype,"egretx.UIEntityManager")}(egretx||(egretx={})),function(e){var t=function(t){function i(i,n){var r=t.call(this)||this;return r.manager=i,r.id=n,r.entities=new xgame.List,r.name=""+e.UILayerID[n],r.touchEnabled=!1,r}return __extends(i,t),Object.defineProperty(i.prototype,"count",{get:function(){return this.entities.count()},enumerable:!0,configurable:!0}),i.prototype.addEntity=function(e){this.entities.contains(e)||this.entities.add(e)},i.prototype.removeEntity=function(e){this.entities.contains(e)&&this.entities.remove(e)},i.prototype.orderToFront=function(e){if(this.entities.contains(e)){this.entities.remove(e);var t=this.numChildren-1;t<0&&(t=0),this.setChildIndex(e.uiPage,t),e.mask&&((t=this.numChildren-2)<0&&(t=0),this.setChildIndex(e.mask,t)),this.entities.add(e)}},i}(eui.UILayer);e.UILayerManager=t,__reflect(t.prototype,"egretx.UILayerManager")}(egretx||(egretx={}));var onDisplayListChanged=new xgame.Signal1,onDisplayListDisposed=new xgame.Signal1,egret_BitmapData_displayList=egret.BitmapData._displayList,egret_BitmapData_addDisplayObject=egret.BitmapData.$addDisplayObject,egret_BitmapData_removeDisplayObject=egret.BitmapData.$removeDisplayObject,egret_BitmapData_dispose=egret.BitmapData.$dispose;function get_timestamp(){return Math.floor((new Date).valueOf()/1e3)}egret.BitmapData.$addDisplayObject=function(e,t){if(t){var i=t.hashCode;i&&(egret_BitmapData_addDisplayObject(e,t),onDisplayListChanged.dispatch(i))}},egret.BitmapData.$removeDisplayObject=function(e,t){if(t){var i=t.hashCode;i&&egret_BitmapData_displayList[i]&&(egret_BitmapData_removeDisplayObject(e,t),onDisplayListChanged.dispatch(i))}},egret.BitmapData.$dispose=function(e){if(e){var t=e.hashCode;t&&(egret_BitmapData_dispose(e),egret_BitmapData_displayList[t]||onDisplayListDisposed.dispatch(t))}},function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.textures=new xgame.Dictionary,onDisplayListChanged.add(t.onDisplayListChanged,t),onDisplayListDisposed.add(t.onDisplayListDisposed,t),t}return __extends(t,e),t.prototype.gc=function(e){var t=this,i=get_timestamp();this.textures.forValues(function(n){n.reference<=0&&(e||i-n.timestamp>=60)&&(t.destroyRes(n.key),t.textures.remove(n.hashCode))},this,!0)},t.prototype.destroyRes=function(e){RES.hasRes(e)&&RES.getRes(e)&&(RES.destroyRes(e),console.log("UIResManager:destroyRes({0})".format(e)))},t.prototype.onDisplayListChanged=function(e){if(this.textures.containsKey(e)||this.textures.add(e,{hashCode:e,reference:0,timestamp:get_timestamp(),key:""}),egret_BitmapData_displayList[e]){var t=this.textures.get(e),i=egret_BitmapData_displayList[e];t.reference=i.length,t.timestamp=get_timestamp()}},t.prototype.onDisplayListDisposed=function(e){this.textures.containsKey(e)&&this.textures.remove(e)},t.prototype.register=function(e,t){if(t){var i=t.bitmapData;if(i){var n=i.hashCode;n&&(this.textures.containsKey(n)?this.textures.get(n).key=e:this.textures.add(n,{hashCode:n,reference:0,timestamp:get_timestamp(),key:e}))}}},t}(xgame.XObject);e.UIResManager=t,__reflect(t.prototype,"egretx.UIResManager")}(egretx||(egretx={})),function(e){e.alert=function(i,n,r,o){var a;return void 0===o&&(o=!0),"string"==typeof i?(a={message:i,title:n,showCloseButton:!0,closeByMask:!0},null!=r&&(Array.isArray(r)?(a.buttons=r,a.closeByMask=o):"number"==typeof r?(a.numButton=r,a.closeByMask=o):"boolean"==typeof r&&(a.closeByMask=r))):a=i,a.callback=new xgame.Signal1,xgame.that.getService(e.IUIManager).openUI(t,a),a.callback};var t=function(t){function i(n){var r=t.call(this,n.skinName||i.defaultSkinName)||this;return r.options=n,r.clickButtonIndex=void 0,r.options.closeByMask||(r.flags&=~e.UIFlags.closeByMask),r.options.width&&(r.width=r.options.width),r.options.height&&(r.height=r.options.height),r}return __extends(i,t),i.prototype.close=function(){this.options.callback&&this.options.callback.dispatch(this.clickButtonIndex),t.prototype.close.call(this)},i.prototype.onClose=function(){this.options.callback&&this.options.callback.removeAll(),this.options.callback=void 0,this.options.buttons=void 0,t.prototype.onClose.call(this)},i.prototype.getButton=function(e){return this["btn_{0}".format(e)]},i.prototype.onOpen=function(){var e=this;t.prototype.onOpen.call(this),this.addClick(this.btn_close,function(){e.close()},this),this.options.showCloseButton||(this.btn_close.visible=!1),this.options.title&&(this.lab_title.textFlow=(new egret.HtmlTextParser).parse(this.options.title)),this.lab_content.textFlow=(new egret.HtmlTextParser).parse(this.options.message);for(var i=[],n=0;;){var r=this.getButton(n);if(!r)break;i.push(r),n++}for(var o=0;o<i.length;o++)i[o].visible=!1,i[o].name=o.toString(),i[o].includeInLayout=!1,this.addClick(i[o],this.onButtonClick,this);if(this.options.buttons&&this.options.buttons.length)for(o=0;o<this.options.buttons.length;o++)i[o].label=this.options.buttons[o],i[o].visible=!0,i[o].includeInLayout=!0;else{var a=this.options.numButton||2;for(o=0;o<a;o++)i[o].visible=!0,i[o].includeInLayout=!0}},i.prototype.onButtonClick=function(e){var t=e.target;this.clickButtonIndex=parseInt(t.name),this.close()},i.defaultSkinName="",i.NAME="Alert",__decorate([e.inject(e.IUIManager),__metadata("design:type",Object)],i.prototype,"uiManager",void 0),i}(e.Window);e.Alert=t,__reflect(t.prototype,"egretx.Alert")}(egretx||(egretx={})),function(e){var t=egret.sys;function i(e,i){return t.measureText(e,i.fontFamily,i.size,i.bold,i.italic)}e.get_measure_width=i;var n,r=1;!function(e){e[e.Any=1]="Any",e[e.Source=1<<r++]="Source",e[e.TextColor=1<<r++]="TextColor",e[e.Align=1<<r++]="Align",e[e.Value=1<<r++]="Value",e[e.Dispatch=1<<r++]="Dispatch",e[e.ItemRenderSkinName=1<<r++]="ItemRenderSkinName"}(n||(n={}));var o=function(t){function r(){var e=t.call(this)||this;return e.invalidateFlags=n.Any,e.callback_onSelectChanged=new xgame.Signal3,e.$isOpened=!1,e.$textColor=6319521,e.$popupItemHeight=46,e.$popupTextAlign=egret.HorizontalAlign.CENTER,e.$textAlign=egret.HorizontalAlign.CENTER,e.$selectedIndex=-1,e.$itemRenderGap=0,e.isLate=!1,e}return __extends(r,t),r.toSource=function(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i];t.push({label:r})}return t},r.itemToLabel=function(e){return e.label?e.label:e.toString()},r.prototype.onSelectChanged=function(){return this.callback_onSelectChanged},r.prototype.$onRemoveFromStage=function(){this.callback_onSelectChanged.removeAll(),t.prototype.$onRemoveFromStage.call(this)},r.prototype.dispose=function(){this.callback_onSelectChanged.removeAll()},r.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.touchChildren=!1,this.lab_title.multiline=!1,this.lab_title.wordWrap=!1,this.addClick(this,function(){e.source&&0!=e.source.length&&e.openPopup()},this)},Object.defineProperty(r.prototype,"isOpened",{get:function(){return this.$isOpened},enumerable:!0,configurable:!0}),r.prototype.openPopup=function(){var t=this;if(!this.isOpened){this.$isOpened=!0;for(var i=[],n=0;n<this.source.length;n++)i.push(this.getMenuItem(n));this.options={enableClick:!0,items:i,itemGap:this.itemRenderGap?this.itemRenderGap:2,itemHeight:this.popupItemHeight,selected:this.selectedIndex,allowDirections:[e.UIDirection.BOTTOM,e.UIDirection.TOP],uiDirection:e.UIDirection.ANY,minWidth:this.width,textAlign:this.popupTextAlign,itemRender:this.popupItemRender,itemRenderSkinName:this.popupItemRenderSkinName||r.defaultItemRenderSkinName,arrowPadding:this.popupArrowPadding,offset:this.popupOffset},this.img_icon.scaleY=-1,e.showPopupMenu(this,this.options).addOnce(function(e){e&&t.setSelectedIndex(e.index,!0),t.img_icon.scaleY=1,t.$isOpened=!1,t.options.instance=void 0,t.options=void 0},this)}},r.prototype.closePopup=function(){this.isOpened&&(this.img_icon.scaleY=1,this.$isOpened=!1,this.options&&this.options.instance&&(this.options.instance.close(),this.options.instance=void 0),this.options=void 0)},Object.defineProperty(r.prototype,"textColor",{get:function(){return this.$textColor},set:function(e){this.$textColor=e,this.invalidateFlags|=n.TextColor,this.lateUpdate()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"popupItemHeight",{get:function(){return this.$popupItemHeight},set:function(e){this.$popupItemHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"popupTextAlign",{get:function(){return this.$popupTextAlign},set:function(e){this.$popupTextAlign=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"textAlign",{get:function(){return this.$textAlign},set:function(e){this.$textAlign=e,this.invalidateFlags|=n.Align,this.lateUpdate()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"selectedIndex",{get:function(){return this.$selectedIndex},set:function(e){e<0||e==this.selectedIndex||this.setSelectedIndex(e)},enumerable:!0,configurable:!0}),r.prototype.setSelectedIndex=function(e,t){this.$selectedIndex=e,this.invalidateFlags|=n.Value,t&&this.callback_onSelectChanged.dispatch(e,this.source[e],this),this.lateUpdate()},Object.defineProperty(r.prototype,"selectedItem",{get:function(){if(this.selectedIndex>=0&&this.source.length)return this.source[this.selectedIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"source",{get:function(){return this.$source},set:function(e){this.$source=e,this.invalidateFlags|=n.Source,this.minWidth=0;for(var t=0,r=e;t<r.length;t++){var o=r[t],a=i(this.getTitle(o),this.lab_title)+75;this.minWidth<a&&(this.minWidth=a)}this.lateUpdate()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"itemRenderGap",{get:function(){return this.$itemRenderGap},set:function(e){this.$itemRenderGap=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"popupItemRenderSkinName",{get:function(){return this.$popupItemRenderSkinName},set:function(e){this.$popupItemRenderSkinName=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"popupItemRender",{get:function(){return this.$popupItemRender},set:function(e){this.$popupItemRender=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"popupArrowPadding",{get:function(){return this.$popupArrowPadding},set:function(e){this.$popupArrowPadding=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"popupOffset",{get:function(){return this.$popupOffset},set:function(e){this.$popupOffset=e},enumerable:!0,configurable:!0}),r.prototype.lateUpdate=function(){var e=this;this.isLate||(this.isLate=!0,egret.callLater(function(){e.onDrawComponent(),e.isLate=!1},this))},r.prototype.getMenuItem=function(e){var t={index:e},i=this.source[e];return t.title=this.getTitle(i),t},r.prototype.getTitle=function(e){return this.itemToLabel?this.itemToLabel(e):r.itemToLabel(e)},r.prototype.onDrawComponent=function(){-1==this.selectedIndex&&(this.selectedIndex=0);var e=this.source&&this.source.length?this.source[this.selectedIndex]:void 0;(this.invalidateFlags==n.Any||this.invalidateFlags&n.Source)&&(this.invalidateFlags|=n.Value),(this.invalidateFlags==n.Any||this.invalidateFlags&n.Value)&&e&&(this.lab_title.text=this.getTitle(e)),(this.invalidateFlags==n.Any||this.invalidateFlags&n.TextColor)&&(this.lab_title.textColor=this.textColor),(this.invalidateFlags==n.Any||this.invalidateFlags&n.Align)&&(this.lab_title.textAlign=this.textAlign),this.invalidateFlags=0},r.defaultItemRenderSkinName="",r}(e.UIComponent);e.DropdownList=o,__reflect(o.prototype,"egretx.DropdownList",["xgame.IPoolable","xgame.IDisposable"])}(egretx||(egretx={})),function(e){var t,i=1;!function(e){e[e.Any=1]="Any",e[e.Source=1<<i++]="Source",e[e.TextColor=1<<i++]="TextColor",e[e.Align=1<<i++]="Align",e[e.Value=1<<i++]="Value",e[e.SelectedIndex=1<<i++]="SelectedIndex",e[e.ItemSkinName=1<<i++]="ItemSkinName"}(t||(t={}));var n=function(i){function n(){var n=i.call(this)||this;return n.invalidateFlags=t.Any,n.callback_onSelectChanged=new xgame.Signal3,n.$textColor=6319521,n.$popupItemHeight=0,n.$popupTextAlign=egret.HorizontalAlign.CENTER,n.$textAlign=egret.HorizontalAlign.CENTER,n.isLate=!1,n.selectedIndexes=[],n.items=[],n.pools=new xgame.PoolObject(e.DropdownList),n}return __extends(n,i),n.prototype.destroy=function(){this.pools.release()},n.prototype.onSelectChanged=function(){return this.callback_onSelectChanged},Object.defineProperty(n.prototype,"dropdownSkinName",{get:function(){return this.$dropdownSkinName},set:function(e){this.$dropdownSkinName=e,this.invalidateFlags|=t.ItemSkinName,this.lateUpdate()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"popupItemRenderSkinName",{get:function(){return this.$popupItemRenderSkinName},set:function(e){this.$popupItemRenderSkinName=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textColor",{get:function(){return this.$textColor},set:function(e){this.$textColor=e,this.invalidateFlags|=t.TextColor,this.lateUpdate()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"popupItemHeight",{get:function(){return this.$popupItemHeight},set:function(e){this.$popupItemHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"popupTextAlign",{get:function(){return this.$popupTextAlign},set:function(e){this.$popupTextAlign=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textAlign",{get:function(){return this.$textAlign},set:function(e){this.$textAlign=e,this.invalidateFlags|=t.Align,this.lateUpdate()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"source",{get:function(){return this.$source},set:function(e){this.$source=e,this.invalidateFlags|=t.Source,this.selectedIndexes.length=0;for(var i=0,n=e;i<n.length;i++){var r=n[i];this.selectedIndexes.push(null!=r.selectedIndex?r.selectedIndex:0)}this.lateUpdate()},enumerable:!0,configurable:!0}),n.prototype.getSelectedIndexes=function(){return this.selectedIndexes},n.prototype.getSelectedIndex=function(e){return e<this.selectedIndexes.length?this.selectedIndexes[e]:-1},n.prototype.setSelectedIndexes=function(e){var i=e.length;i=Math.min(i,this.source.length);for(var n=0;n<i;n++)this.selectedIndexes[n]=e[n];this.invalidateFlags|=t.SelectedIndex,this.lateUpdate()},n.prototype.setSelectedIndex=function(e,i){e<this.items.length&&(this.selectedIndexes[e]=i,this.invalidateFlags|=t.SelectedIndex,this.lateUpdate())},n.prototype.lateUpdate=function(){var e=this;this.isLate||(this.isLate=!0,egret.callLater(function(){e.onDrawComponent(),e.isLate=!1},this))},n.prototype.onDrawComponent=function(){if((this.invalidateFlags==t.Any||this.invalidateFlags&t.Source)&&(this.clearItems(),this.initItems()),this.invalidateFlags==t.Any||this.invalidateFlags&t.Align)for(var e=0,i=this.items;e<i.length;e++){var n=i[e];n.textAlign=this.textAlign,n.popupTextAlign=this.popupTextAlign}if(this.invalidateFlags==t.Any||this.invalidateFlags&t.SelectedIndex)for(var r=0;r<this.selectedIndexes.length;r++)this.getItemAt(r).selectedIndex=this.selectedIndexes[r];this.invalidateFlags=0},n.prototype.clearItems=function(){for(;this.items.length;){var e=this.items.pop();this.removeChild(e),this.pools.recycle(e)}},n.prototype.initItems=function(){if(this.source&&0!=this.source.length)for(var e=0;e<this.source.length;e++){var t=this.source[e],i=this.getItemAt(e);i.selectedIndex=this.selectedIndexes[e],i.textAlign=this.textAlign,i.popupTextAlign=this.popupTextAlign,i.popupItemHeight=this.popupItemHeight?this.popupItemHeight:n.defaultPopupItemHeight,i.source=t.source,i.skinName=this.dropdownSkinName||n.defaultDropdownSkinName,i.popupItemRenderSkinName=this.popupItemRenderSkinName}},n.prototype.getItemAt=function(e){var t=this;if(!this.items[e]){var i=this.pools.fetch(function(){return t.fetchDropdownList?t.fetchDropdownList():n.defaultFetchDropdownList()},this);i.onSelectChanged().add(this.onSelectChangeHandler,this),this.items[e]=i,this.addChildAt(i,e)}return this.items[e]},n.prototype.indexOf=function(e){return this.items.indexOf(e)},n.prototype.onSelectChangeHandler=function(e,t,i){var n=this.indexOf(i);this.selectedIndexes[n]=e;for(var r=this.selectedIndexes.slice(),o=[],a=0;a<this.selectedIndexes.length;a++)o.push(this.getItemAt(a).source[this.selectedIndexes[a]]);this.callback_onSelectChanged.dispatch(n,r,o)},n.defaultDropdownSkinName="",n.defaultPopupItemHeight=30,n}(e.Group);e.DropdownListGroup=n,__reflect(n.prototype,"egretx.DropdownListGroup")}(egretx||(egretx={})),function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.ITEM_CLICK="PopupMenuEvent_itemClick",t}(egret.Event);e.PopupMenuEvent=t,__reflect(t.prototype,"egretx.PopupMenuEvent");var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),Object.defineProperty(i.prototype,"item",{get:function(){return this.data},enumerable:!0,configurable:!0}),i.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.left=this.right=0},i.prototype.childrenCreated=function(){var i=this;e.prototype.childrenCreated.call(this),this.addClick(this,function(){i.item&&i.dispatchEvent(new t(t.ITEM_CLICK,!0,!0,i.item))},this)},i.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.item&&(this.lab_title.textFlow=(new egret.HtmlTextParser).parse("{0}".format(this.item.title)),this.item.textAlign&&(this.lab_title.textAlign=this.item.textAlign))},i}(e.ItemRenderer);e.PopupMenuItem=i,__reflect(i.prototype,"egretx.PopupMenuItem");var n=function(n){function r(t){var i=n.call(this,t.skinName||r.defaultSkinName)||this;i.options=t,i.callback_onSelect=new xgame.Signal1,i.arrowPadding=20,t.instance=i,t.offset&&(i.offset.x=t.offset.x,i.offset.y=t.offset.y),null==t.arrowPadding&&(t.arrowPadding=20),t.width&&(i.width=t.width),t.height&&(i.height=t.height),null==t.uiDirection&&(t.uiDirection=e.UIDirection.BOTTOM),null==t.uiAlign&&(t.uiAlign=e.UIAlign.CENTER),t.itemHeight=t.itemHeight?t.itemHeight:30,t.itemGap=null!=t.itemGap?t.itemGap:2,t.allowDirections&&t.allowDirections.length&&(i.allowDirections=t.allowDirections),i.$uiDirection=t.uiDirection,i.$uiAlign=t.uiAlign,i.arrowPadding=t.arrowPadding;var o=i.options.baseHeight||r.defaultBaseHeight;return i.options.height||(i.height=o+(i.options.itemHeight+i.options.itemGap)*i.options.items.length-i.options.itemGap),!i.options.width&&i.options.minWidth&&i.width<i.options.minWidth&&(i.width=i.options.minWidth),i}return __extends(r,n),r.toOptions=function(e,t){for(var i={items:[],selected:null==t?0:t},n=0;n<e.length;n++)i.items.push({index:n,title:e[n]});return i},r.prototype.onSelect=function(){return this.options.callback||this.callback_onSelect},r.prototype.fixedUIDirection=function(e){this.updateArrow(e)},r.prototype.onClose=function(){this.onSelect().dispatch(this.selectedItem),this.list_item.removeEventListener(t.ITEM_CLICK,this.onItemClickHandler,this),this.options&&(this.options.instance=void 0),n.prototype.onClose.call(this)},r.prototype.onItemClickHandler=function(e){e.stopPropagation(),this.selectedItem=e.data,this.close()},r.prototype.onOpen=function(){if(n.prototype.onOpen.call(this),this.list_item.itemRenderer=this.options.itemRender,this.list_item.layout.gap=this.options.itemGap,this.options.itemRenderSkinName&&(this.list_item.itemRendererSkinName=this.options.itemRenderSkinName),this.options.itemRender?this.list_item.itemRenderer=this.options.itemRender:this.list_item.itemRenderer=i,this.list_item.addEventListener(t.ITEM_CLICK,this.onItemClickHandler,this),this.list_item.replaceAll(this.options.items),null!=this.options.selected){var e=this.options.selected;e>=0&&(this.list_item.selectedIndex=e)}},r.prototype.updateArrow=function(t){this.arrow_down.visible=!1,this.arrow_up.visible=!1,this.arrow_left.visible=!1,this.arrow_right.visible=!1,t==e.UIDirection.BOTTOM?(this.arrow_down.visible=!0,this.uiAlign==e.UIAlign.LEFT?(this.arrow_down.horizontalCenter=NaN,this.arrow_down.left=this.arrowPadding,this.arrow_down.right=NaN):this.uiAlign==e.UIAlign.RIGHT?(this.arrow_down.horizontalCenter=NaN,this.arrow_down.left=NaN,this.arrow_down.right=this.arrowPadding):(this.arrow_down.horizontalCenter=0,this.arrow_down.left=NaN,this.arrow_down.right=NaN)):t==e.UIDirection.TOP?(this.arrow_up.visible=!0,this.uiAlign==e.UIAlign.LEFT?(this.arrow_up.horizontalCenter=NaN,this.arrow_up.left=this.arrowPadding,this.arrow_up.right=NaN):this.uiAlign==e.UIAlign.RIGHT?(this.arrow_up.horizontalCenter=NaN,this.arrow_up.left=NaN,this.arrow_up.right=this.arrowPadding):(this.arrow_up.horizontalCenter=0,this.arrow_up.left=NaN,this.arrow_up.right=NaN)):t==e.UIDirection.RIGHT?(this.arrow_right.visible=!0,this.uiAlign==e.UIAlign.TOP?(this.arrow_right.verticalCenter=NaN,this.arrow_right.top=this.arrowPadding,this.arrow_right.bottom=NaN):this.uiAlign==e.UIAlign.BOTTOM?(this.arrow_right.verticalCenter=NaN,this.arrow_right.top=NaN,this.arrow_right.bottom=this.arrowPadding):(this.arrow_right.verticalCenter=0,this.arrow_right.top=NaN,this.arrow_right.bottom=NaN)):t==e.UIDirection.LEFT?(this.arrow_left.visible=!0,this.uiAlign==e.UIAlign.TOP?(this.arrow_left.verticalCenter=NaN,this.arrow_left.top=this.arrowPadding,this.arrow_left.bottom=NaN):this.uiAlign==e.UIAlign.BOTTOM?(this.arrow_left.verticalCenter=NaN,this.arrow_left.top=NaN,this.arrow_left.bottom=this.arrowPadding):(this.arrow_left.verticalCenter=0,this.arrow_left.top=NaN,this.arrow_left.bottom=NaN)):(this.arrow_down.visible=!0,this.uiAlign==e.UIAlign.LEFT?(this.arrow_down.horizontalCenter=NaN,this.arrow_down.left=this.arrowPadding,this.arrow_down.right=NaN):this.uiAlign==e.UIAlign.RIGHT?(this.arrow_down.horizontalCenter=NaN,this.arrow_down.left=NaN,this.arrow_down.right=this.arrowPadding):(this.arrow_down.horizontalCenter=0,this.arrow_down.left=NaN,this.arrow_down.right=NaN))},r.NAME="PopupMenu",r.defaultSkinName="",r.defaultBaseHeight=40,r}(e.Popup);e.PopupMenu=n,__reflect(n.prototype,"egretx.PopupMenu"),e.showPopupMenu=function(t,i){var r;if((r=Array.isArray(i)?n.toOptions(i):i).callback=new xgame.Signal1,r.textAlign)for(var o=0,a=r.items;o<a.length;o++)a[o].textAlign=r.textAlign;return xgame.that.getService(e.IUIManager).openPopup(n,t,r),r.callback}}(egretx||(egretx={})),function(e){var t;!function(e){e[e.FadeIn=1]="FadeIn",e[e.Stay=2]="Stay",e[e.FadeOut=3]="FadeOut"}(t=e.TipsState||(e.TipsState={}));var i=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.durationFadeIn=500,t.durationStay=1e3,t.durationFadeOut=500,t.durationPosition=500,t.time=0,t.index=0,t}return __extends(i,e),Object.defineProperty(i.prototype,"state",{get:function(){return this.$state},set:function(e){this.$state=e},enumerable:!0,configurable:!0}),i.prototype.release=function(){},i.prototype.dispose=function(){egret.Tween.removeTweens(this)},i.prototype.setMessage=function(e){this.time=this.durationStay,this.state=t.FadeIn,this.y=-this.height/2,this.alpha=0},i.prototype.doFadeIn=function(){var e=this;return new Promise(function(t){var i=e.alpha,n=Math.floor(e.durationFadeIn*(1-i));egret.Tween.get(e).to({alpha:1},n).call(function(){t()},e)})},i.prototype.doFadeOut=function(){var e=this;return new Promise(function(t){var i=e.alpha,n=Math.floor(e.durationFadeOut*i);egret.Tween.get(e).to({alpha:0},n).call(function(){t()},e)})},i.prototype.doStay=function(){var e=this;return new Promise(function(t){egret.Tween.get(e).to({time:0},e.time).call(function(){t()},e)})},i.prototype.playAnimation=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return egret.Tween.removeTweens(this),egret.Tween.get(this).to({y:-this.index*this.height-this.height/2},this.durationPosition),this.state!=t.FadeIn?[3,4]:[4,this.doFadeIn()];case 1:return e.sent(),this.state=t.Stay,[4,this.doStay()];case 2:return e.sent(),this.state=t.FadeOut,[4,this.doFadeOut()];case 3:return e.sent(),[3,9];case 4:return this.state!=t.Stay?[3,7]:[4,this.doStay()];case 5:return e.sent(),this.state=t.FadeOut,[4,this.doFadeOut()];case 6:return e.sent(),[3,9];case 7:return this.state!=t.FadeOut?[3,9]:[4,this.doFadeOut()];case 8:e.sent(),e.label=9;case 9:return[2]}})})},i}(eui.Component);e.TipsView=i,__reflect(i.prototype,"egretx.TipsView",["egretx.ITipsView","xgame.IPoolable","xgame.IDisposable","xgame.IXObject"]);var n=function(t){function n(){var e=t.call(this)||this;return e.pools=new xgame.PoolObject(i),e.parallelMax=5,e.waitQueues=[],e}return __extends(n,t),Object.defineProperty(n.prototype,"container",{get:function(){return this.$container},enumerable:!0,configurable:!0}),n.prototype.append=function(e){this.container.numChildren<this.parallelMax?this.play(e):this.waitQueues.push(e)},n.prototype.play=function(e){var t=this,i=this.pools.fetch(function(){return t.fetch()},this);this.container.addChildAt(i,0),i.setMessage(e);for(var n=function(e){var i=r.container.getChildAt(e);i.index=e,egret.Tween.removeTweens(i),i.playAnimation().then(function(){t.endView(i)})},r=this,o=0;o<this.container.numChildren;o++)n(o)},n.prototype.endView=function(e){if(e.parent&&this.container.removeChild(e),e.dispose(),this.pools.recycle(e),this.waitQueues.length>0&&this.container.numChildren<this.parallelMax){var t=this.waitQueues.shift();this.play(t)}},n.prototype.clear=function(){for(;this.container.numChildren;){var e=this.container.removeChildAt(0);e.dispose(),this.pools.recycle(e)}this.waitQueues.length=0},n.prototype.initialize=function(){this.$container=new eui.Group,this.$container.width=this.$container.height=1,this.$container.touchChildren=!1,this.$container.touchEnabled=!1,this.$container.touchThrough=!0,this.$container.horizontalCenter=0,this.$container.verticalCenter=0,xgame.that.getService(e.IUIManager).getLayerManager(e.UILayerID.Layer_11_Toast).addChild(this.$container)},n}(xgame.Singleton);e.TipsManager=n,__reflect(n.prototype,"egretx.TipsManager")}(egretx||(egretx={})),function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.gap=10,t}return __extends(t,e),t}(xgame.XObject);e.UIOptions=t,__reflect(t.prototype,"egretx.UIOptions")}(egretx||(egretx={})),function(e){e.ISceneTransition=Symbol.for("ISceneTransition")}(egretx||(egretx={})),function(e){var t=function(t){function i(){var e=t.call(this)||this;return xgame.injectInstance(e),e}return __extends(i,t),i.prototype.start=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},__decorate([xgame.inject(e.IUIManager),__metadata("design:type",Object)],i.prototype,"uiManager",void 0),i=__decorate([xgame.impl(e.ISceneTransition),__metadata("design:paramtypes",[])],i)}(xgame.XObject);e.SceneTransition=t,__reflect(t.prototype,"egretx.SceneTransition",["egretx.ISceneTransition","xgame.IXObject"])}(egretx||(egretx={})),function(e){var t=function(t){function i(i,n,r){void 0===i&&(i=128),void 0===n&&(n=500),void 0===r&&(r=e.SceneMotion.RANDOM);var o=t.call(this)||this;return o.blockSize=i,o.duration=n,o.style=r,o}return __extends(i,t),i.prototype.start=function(t){var i=this;return new Promise(function(n,r){var o=i.uiManager.getLayerManager(e.UILayerID.Layer_3_SceneMask),a=i.uiManager.stage.stageWidth,s=i.uiManager.stage.stageHeight,h=new eui.Group;h.top=h.bottom=h.left=h.right=0,o.addChild(h);for(var c=i.blockSize,l=c,u=c,p=Math.ceil(a/l),d=Math.ceil(s/u),g=p*d,f=i.duration,_=0,y=0,m=0;m<g;m++){_=m%p,y=Math.floor(m/p);var v=m%p*l,I=Math.floor(m/p)*u,x=new egret.RenderTexture;x.drawToTexture(t,new egret.Rectangle(v,I,l,u));var T=e.BitmapPools.Instance().fetch();T.alpha=1,T.scaleX=T.scaleY=1,T.rotation=0,T.texture=x,T.anchorOffsetX=l/2,T.anchorOffsetY=u/2,T.x=v+l/2,T.y=I+u/2,h.addChild(T);var w=0;w=i.style==e.SceneMotion.TOP?10*m:i.style==e.SceneMotion.BOTTOM?10*(g-1-m):i.style==e.SceneMotion.LEFT?_*d*10+10*y:i.style==e.SceneMotion.RIGHT?(p-_)*d*10+10*y:i.style==e.SceneMotion.TOP_LEFT?_*y*10:i.style==e.SceneMotion.TOP_RIGHT?(p-_)*y*10:i.style==e.SceneMotion.BOTTOM_LEFT?_*(d-y)*10:i.style==e.SceneMotion.BOTTOM_RIGHT?(p-_)*(d-y)*10:Math.floor(300*Math.random()),egret.Tween.get(T).wait(w).to({alpha:0},f,egret.Ease.circIn).call(S,i,[T])}var b=0;function S(t){e.BitmapPools.Instance().recycle(t),++b==g&&(o.removeChild(h),n())}})},i}(e.SceneTransition);e.SceneFadeTransition=t,__reflect(t.prototype,"egretx.SceneFadeTransition")}(egretx||(egretx={})),function(e){var t=function(t){function i(e,i){void 0===e&&(e=8),void 0===i&&(i=500);var n=t.call(this)||this;return n.countBlocks=e,n.duration=i,n}return __extends(i,t),i.prototype.start=function(t){var i=this;return new Promise(function(n,r){var o=i.uiManager.getLayerManager(e.UILayerID.Layer_3_SceneMask),a=i.uiManager.stage.stageWidth,s=i.uiManager.stage.stageHeight,h=new eui.Group;h.top=h.bottom=h.left=h.right=0,o.addChild(h);for(var c=i.countBlocks,l=a/1,u=s/(c/1),p=i.duration,d=0;d<c;d++){var g=d%1*l,f=Math.floor(d/1)*u,_=new egret.RenderTexture;_.drawToTexture(t,new egret.Rectangle(g,f,l,u));var y=e.BitmapPools.Instance().fetch();y.alpha=1,y.scaleX=y.scaleY=1,y.rotation=0,y.texture=_,y.anchorOffsetX=l/2,y.anchorOffsetY=u/2,y.x=g+l/2,y.y=f+u/2,h.addChild(y),egret.Tween.get(y).to({scaleX:1,scaleY:.2,alpha:0},p,egret.Ease.circIn).call(v,i,[y])}var m=0;function v(t){e.BitmapPools.Instance().recycle(t),++m==c&&(o.removeChild(h),n())}})},i}(e.SceneTransition);e.SceneHShuttersTransition=t,__reflect(t.prototype,"egretx.SceneHShuttersTransition")}(egretx||(egretx={})),function(e){!function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e[e.RANDOM=4]="RANDOM",e[e.TOP_LEFT=5]="TOP_LEFT",e[e.TOP_RIGHT=6]="TOP_RIGHT",e[e.BOTTOM_LEFT=7]="BOTTOM_LEFT",e[e.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"}(e.SceneMotion||(e.SceneMotion={}))}(egretx||(egretx={})),function(e){var t=function(t){function i(i,n,r){void 0===i&&(i=128),void 0===n&&(n=500),void 0===r&&(r=e.SceneMotion.RANDOM);var o=t.call(this)||this;return o.blockSize=i,o.duration=n,o.style=r,o}return __extends(i,t),i.prototype.start=function(t){var i=this;return new Promise(function(n,r){var o=i.uiManager.getLayerManager(e.UILayerID.Layer_3_SceneMask),a=i.uiManager.stage.stageWidth,s=i.uiManager.stage.stageHeight,h=new eui.Group;h.top=h.bottom=h.left=h.right=0,o.addChild(h);for(var c=i.blockSize,l=c,u=c,p=Math.ceil(a/l),d=Math.ceil(s/u),g=p*d,f=i.duration,_=0,y=0,m=0;m<g;m++){_=m%p,y=Math.floor(m/p);var v=m%p*l,I=Math.floor(m/p)*u,x=new egret.RenderTexture;x.drawToTexture(t,new egret.Rectangle(v,I,l,u));var T=e.BitmapPools.Instance().fetch();T.alpha=1,T.scaleX=T.scaleY=1,T.rotation=0,T.texture=x,T.anchorOffsetX=l/2,T.anchorOffsetY=u/2,T.x=v+l/2,T.y=I+u/2,h.addChild(T);var w=0;w=i.style==e.SceneMotion.TOP?10*m:i.style==e.SceneMotion.BOTTOM?10*(g-1-m):i.style==e.SceneMotion.LEFT?_*d*10+10*y:i.style==e.SceneMotion.RIGHT?(p-_)*d*10+10*y:i.style==e.SceneMotion.TOP_LEFT?_*y*10:i.style==e.SceneMotion.TOP_RIGHT?(p-_)*y*10:i.style==e.SceneMotion.BOTTOM_LEFT?_*(d-y)*10:i.style==e.SceneMotion.BOTTOM_RIGHT?(p-_)*(d-y)*10:Math.floor(300*Math.random()),egret.Tween.get(T).wait(w).to({scaleX:0,scaleY:0,alpha:0,rotation:359},f,egret.Ease.circIn).call(S,i,[T])}var b=0;function S(t){e.BitmapPools.Instance().recycle(t),++b==g&&(o.removeChild(h),n())}})},i}(e.SceneTransition);e.SceneRotateTransition=t,__reflect(t.prototype,"egretx.SceneRotateTransition")}(egretx||(egretx={})),function(e){var t=function(t){function i(i,n,r){void 0===i&&(i=128),void 0===n&&(n=500),void 0===r&&(r=e.SceneMotion.RANDOM);var o=t.call(this)||this;return o.blockSize=i,o.duration=n,o.style=r,o}return __extends(i,t),i.prototype.start=function(t){var i=this;return new Promise(function(n,r){var o=i.uiManager.getLayerManager(e.UILayerID.Layer_3_SceneMask),a=i.uiManager.stage.stageWidth,s=i.uiManager.stage.stageHeight,h=new eui.Group;h.top=h.bottom=h.left=h.right=0,o.addChild(h);for(var c=i.blockSize,l=c,u=c,p=Math.ceil(a/l),d=Math.ceil(s/u),g=p*d,f=i.duration,_=0,y=0,m=0;m<g;m++){_=m%p,y=Math.floor(m/p);var v=m%p*l,I=Math.floor(m/p)*u,x=new egret.RenderTexture;x.drawToTexture(t,new egret.Rectangle(v,I,l,u));var T=e.BitmapPools.Instance().fetch();T.alpha=1,T.scaleX=T.scaleY=1,T.rotation=0,T.texture=x,T.anchorOffsetX=l/2,T.anchorOffsetY=u/2,T.x=v+l/2,T.y=I+u/2,h.addChild(T);var w=0;w=i.style==e.SceneMotion.TOP?10*m:i.style==e.SceneMotion.BOTTOM?10*(g-1-m):i.style==e.SceneMotion.LEFT?_*d*10+10*y:i.style==e.SceneMotion.RIGHT?(p-_)*d*10+10*y:i.style==e.SceneMotion.TOP_LEFT?_*y*10:i.style==e.SceneMotion.TOP_RIGHT?(p-_)*y*10:i.style==e.SceneMotion.BOTTOM_LEFT?_*(d-y)*10:i.style==e.SceneMotion.BOTTOM_RIGHT?(p-_)*(d-y)*10:Math.floor(300*Math.random()),egret.Tween.get(T).wait(w).to({scaleX:0,scaleY:0,alpha:0},f,egret.Ease.circIn).call(S,i,[T])}var b=0;function S(t){e.BitmapPools.Instance().recycle(t),++b==g&&(o.removeChild(h),n())}})},i}(e.SceneTransition);e.SceneScaleTransition=t,__reflect(t.prototype,"egretx.SceneScaleTransition")}(egretx||(egretx={})),function(e){var t=function(t){function i(e,i){void 0===e&&(e=8),void 0===i&&(i=500);var n=t.call(this)||this;return n.countBlocks=e,n.duration=i,n}return __extends(i,t),i.prototype.start=function(t){var i=this;return new Promise(function(n,r){var o=i.uiManager.getLayerManager(e.UILayerID.Layer_3_SceneMask),a=i.uiManager.stage.stageWidth,s=i.uiManager.stage.stageHeight,h=new eui.Group;h.top=h.bottom=h.left=h.right=0,o.addChild(h);for(var c=i.countBlocks,l=i.countBlocks,u=a/l,p=s/(c/l),d=i.duration,g=0;g<c;g++){var f=g%l*u,_=Math.floor(g/l)*p,y=new egret.RenderTexture;y.drawToTexture(t,new egret.Rectangle(f,_,u,p));var m=e.BitmapPools.Instance().fetch();m.alpha=1,m.scaleX=m.scaleY=1,m.rotation=0,m.texture=y,m.anchorOffsetX=u/2,m.anchorOffsetY=p/2,m.x=f+u/2,m.y=_+p/2,h.addChild(m),egret.Tween.get(m).to({scaleX:.2,scaleY:1,alpha:0},d,egret.Ease.circIn).call(I,i,[m])}var v=0;function I(t){t.$bitmapData.$dispose(),e.BitmapPools.Instance().recycle(t),++v==c&&(o.removeChild(h),n())}})},i}(e.SceneTransition);e.SceneVShuttersTransition=t,__reflect(t.prototype,"egretx.SceneVShuttersTransition")}(egretx||(egretx={})),function(e){var t=function(e){function t(t){void 0===t&&(t=500);var i=e.call(this)||this;return i.duration=t,i}return __extends(t,e),t.prototype.start=function(e,t){var i=this;return void 0===t&&(t=!1),new Promise(function(n,r){egret.Tween.removeTweens(e);var o=0,a=1,s=egret.Ease.cubicOut;t&&(o=1,a=0,s=egret.Ease.cubicIn),e.alpha=o,egret.Tween.get(e).to({alpha:a},i.duration,s).call(function(){n()})})},t}(xgame.XObject);e.UIFadeTransition=t,__reflect(t.prototype,"egretx.UIFadeTransition",["egretx.IUITransition","xgame.IXObject"])}(egretx||(egretx={})),function(e){var t=function(e){function t(t){void 0===t&&(t=300);var i=e.call(this)||this;return i.duration=t,i}return __extends(t,e),t.prototype.start=function(e,t){var i=this;return void 0===t&&(t=!1),new Promise(function(n,r){egret.Tween.removeTweens(e);var o=0,a=e.scaleX,s=egret.Ease.backOut;t&&(o=e.scaleX,a=0,s=egret.Ease.backIn),e.scaleX=e.scaleY=o,egret.Tween.get(e).to({scaleX:a,scaleY:a},i.duration,s).call(function(){n()})})},t}(xgame.XObject);e.UIScaleTransition=t,__reflect(t.prototype,"egretx.UIScaleTransition",["egretx.IUITransition","xgame.IXObject"])}(egretx||(egretx={})),function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.release=function(){},t.prototype.dispose=function(){this.$bitmapData&&this.$bitmapData.$dispose(),this.removeSelf()},t.prototype.removeSelf=function(){this.parent&&this.parent.removeChild(this)},t=__decorate([xgame.impl(xgame.IPoolable)],t)}(egret.Bitmap);e.Bitmap=t,__reflect(t.prototype,"egretx.Bitmap",["xgame.IPoolable","xgame.IDisposable","xgame.IXObject"]);var i=function(e){function i(){var i=e.call(this)||this;return i.pools=new xgame.PoolObject(t),i}return __extends(i,e),i.prototype.fetch=function(){return this.pools.fetch(function(){return new t},this)},i.prototype.recycle=function(e){this.pools.recycle(e)},i}(xgame.Singleton);e.BitmapPools=i,__reflect(i.prototype,"egretx.BitmapPools")}(egretx||(egretx={})),function(e){var t=new egret.Rectangle,i=new egret.Rectangle,n=function(){function n(){}return n.placeTipsWithHUD=function(n,r,o){void 0===o&&(o=10);var a=xgame.that.getService(e.IUIManager).stage,s=n.uiDirection,h=n.uiAlign,c=a.stageWidth,l=a.stageHeight;n.getBounds(i,!0),r.getTransformedBounds(n.parent,t);var u=r.width*r.scaleX,p=r.height*r.scaleY,d=n.width,g=n.height,f=t.x,_=t.y,y=f+u,m=_+p;n.allowUIDirection(e.UIDirection.BOTTOM)&&(l-m-2*o>=g&&s==e.UIDirection.ANY||s==e.UIDirection.BOTTOM)?(n.y=m+o,h==e.UIAlign.LEFT?n.x=f:h==e.UIAlign.RIGHT?n.x=y-d:n.x=f+u/2-d/2,n.fixedUIDirection(e.UIDirection.BOTTOM)):n.allowUIDirection(e.UIDirection.TOP)&&(_-2*o>=g&&s==e.UIDirection.ANY||s==e.UIDirection.TOP)?(n.y=_-o-g,h==e.UIAlign.LEFT?n.x=f:h==e.UIAlign.RIGHT?n.x=y-d:n.x=f+u/2-d/2,n.fixedUIDirection(e.UIDirection.TOP)):n.allowUIDirection(e.UIDirection.RIGHT)&&(c-y-2*o>=d&&s==e.UIDirection.ANY||s==e.UIDirection.RIGHT)?(n.x=y+o,h==e.UIAlign.TOP?n.y=_:h==e.UIAlign.BOTTOM?n.y=_+p-g:n.y=_+p/2-g/2,n.fixedUIDirection(e.UIDirection.RIGHT)):n.allowUIDirection(e.UIDirection.LEFT)&&(f-2*o>=d&&s==e.UIDirection.ANY||s==e.UIDirection.LEFT)&&(n.x=f-o-d,h==e.UIAlign.TOP?n.y=_:h==e.UIAlign.BOTTOM?n.y=_+p-g:n.y=_+p/2-g/2,n.fixedUIDirection(e.UIDirection.LEFT)),n.x+=n.offset.x,n.y+=n.offset.y,n.visible=!0},n}();e.TipsHelper=n,__reflect(n.prototype,"egretx.TipsHelper")}(egretx||(egretx={}));